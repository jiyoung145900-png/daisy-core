<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>문서 생성 시스템 (데이지)</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --a4-width: 210mm;
            --a4-height: 297mm;
            --seal-color: #c72c2c; /* 인주색 */
            --paper-color: #fffdf9; /* 약간 미색 종이 */
            --gold-border: #bfa97a; /* 금색 테두리 색상 */
        }
        @font-face {
            font-family: 'Gungsuh';
            src: local('Gungsuh'), local('궁서');
        }
        body {
            font-family: 'Malgun Gothic', dotum, sans-serif;
            margin: 0;
            background-color: #f0f2f5;
            padding: 20px;
        }
        .no-print {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .input-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .btn {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .btn-secondary {
            background-color: #6c757d;
        }
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        .btn-download {
            background-color: #28a745;
            margin-bottom: 20px;
            display: block;
            width: 200px;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .btn-download:hover {
            background-color: #218838;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #007bff;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        .tab-btn {
            padding: 10px 20px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            font-size: 16px;
            font-weight: bold;
            color: #555;
            flex: 1;
        }
        .tab-btn.active {
            color: #007bff;
            border-bottom: 2px solid #007bff;
            margin-bottom: -2px;
        }
        .document-page {
            width: var(--a4-width);
            height: var(--a4-height);
            margin: 0 auto;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 25mm;
            box-sizing: border-box;
            position: relative;
            display: none;
            overflow: hidden; /* 내용이 넘치지 않도록 */
        }
        .document-page.active {
            display: block;
        }

        /* --- 공통 도장 스타일 --- */
        .seal-style {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-2deg);
            color: var(--seal-color);
            border: 4px solid var(--seal-color);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-family: "Gungsuh", serif;
            font-weight: bold;
            line-height: 1.2;
            letter-spacing: -0.5px;
            opacity: 0.9;
            mix-blend-mode: multiply; /* 종이에 스며든 느낌 */
        }

        /* --- 사용인감계 스타일 --- */
        #stampDoc h1 {
            text-align: center;
            font-size: 34px;
            margin-bottom: 40px;
            font-family: "Gungsuh", serif;
            letter-spacing: 5px;
        }
        #stampDoc table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        #stampDoc th, #stampDoc td {
            border: 1px solid #333;
            padding: 12px;
            text-align: center;
            vertical-align: middle;
            font-size: 15px;
        }
        #stampDoc th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .seal-cell {
            position: relative;
            height: 130px;
        }
        .seal-corp {
            width: 95px;
            height: 95px;
            font-size: 15px;
            border-width: 5px;
        }
        .seal-rep-container {
            position: relative;
            display: inline-block;
            padding-right: 60px; /* 도장 공간 확보 */
        }
        .seal-rep {
            width: 65px;
            height: 65px;
            font-size: 13px;
            border-width: 3px;
            left: auto; right: -10px; /* 텍스트 오른쪽에 위치 */
            transform: translate(0, -50%) rotate(-2deg);
        }

        /* --- 사업자등록증 스타일 (리얼함 강조) --- */
        #bizDoc {
            background-color: var(--paper-color);
            padding: 20mm; /* 패딩 약간 조정 */
            /* 이중 테두리로 실제 느낌 모방 */
            border: 5px double var(--gold-border); 
            outline: 1px solid #aaa;
            outline-offset: 3px;
        }
        /* 배경 워터마크 */
        #bizDoc::before {
            content: '대한민국 국세청';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            font-size: 100px;
            color: rgba(200, 180, 150, 0.15); /* 은은한 색상 */
            font-family: "Gungsuh", serif;
            font-weight: bold;
            z-index: 0;
            pointer-events: none;
            white-space: nowrap;
        }
        #bizDoc .content-wrap {
            position: relative;
            z-index: 1;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        #bizDoc h1 {
            text-align: center;
            font-size: 42px;
            font-family: "Gungsuh", serif;
            margin-top: 0;
            margin-bottom: 5px;
            letter-spacing: 8px;
            color: #222;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
        }
        #bizDoc .doc-type {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 35px;
            font-family: "Gungsuh", serif;
        }
        #bizDoc .biz-info-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-bottom: 30px;
            border-top: 2px solid #555;
            border-bottom: 2px solid #555;
        }
        #bizDoc .biz-info-table th, #bizDoc .biz-info-table td {
            padding: 15px 10px;
            text-align: left;
            font-size: 17px;
            border-bottom: 1px solid #ddd;
        }
        #bizDoc .biz-info-table tr:last-child th, 
        #bizDoc .biz-info-table tr:last-child td {
            border-bottom: none;
        }
        #bizDoc .biz-info-table th {
            background-color: transparent;
            width: 140px;
            color: #444;
            font-weight: normal;
            font-family: "Malgun Gothic", sans-serif;
            letter-spacing: -0.5px;
        }
        #bizDoc .biz-info-table td {
            font-weight: bold;
            color: #000;
            font-family: "Malgun Gothic", sans-serif;
        }
        #bizDoc .biz-info-table .merged-row th {
             vertical-align: top;
             padding-top: 20px;
        }
        #bizDoc .issue-info {
            text-align: center;
            margin-top: auto; /* 하단으로 밀어내기 */
            padding-bottom: 30px;
            font-size: 19px;
            font-family: "Gungsuh", serif;
            line-height: 1.8;
        }
        #bizDoc .tax-office-seal-group {
            margin-top: 50px;
            position: relative;
            display: inline-block;
            padding-right: 100px; /* 직인 공간 확보 */
        }
        #bizDoc .tax-office-name {
            font-size: 32px;
            font-weight: bold;
            font-family: "Gungsuh", serif;
            letter-spacing: 3px;
        }
        /* 세무서장 직인 (사각형) */
        .official-seal-rect {
            position: absolute;
            top: 50%;
            right: 0;
            transform: translate(0, -50%) rotate(-1deg);
            width: 90px;
            height: 90px;
            border: 6px solid var(--seal-color);
            color: var(--seal-color);
            font-family: "Gungsuh", serif;
            font-weight: bold;
            font-size: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            line-height: 1.3;
            opacity: 0.9;
            mix-blend-mode: multiply;
            background-color: transparent;
            border-radius: 2px; /* 약간 둥근 모서리 */
        }

        /* --- 인쇄 설정 --- */
        @media print {
            body {
                padding: 0;
                background-color: #fff;
            }
            .no-print, .tabs, .btn-download {
                display: none !important;
            }
            .document-page {
                margin: 0;
                box-shadow: none;
                page-break-after: always;
                display: block !important;
                -webkit-print-color-adjust: exact; /* 배경색 및 이미지 인쇄 강제 */
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>

<div class="no-print">
    <h2>문서 정보 입력</h2>
    <p style="color: #666; font-size: 14px;">* 날짜와 수신인을 변경하고 '문서 내용 적용'을 누르세요.</p>
    <div class="input-group">
        <label for="docDate">개업연월일 / 작성일:</label>
        <input type="date" id="docDate" value="2020-03-20">
    </div>
    <div class="input-group">
        <label for="recipientName">수신인 (사용인감계용):</label>
        <input type="text" id="recipientName" placeholder="예: 홍길동">
    </div>
    <div style="text-align: center; margin-top: 20px;">
        <button class="btn" onclick="updateDocuments()">문서 내용 적용</button>
        <button class="btn btn-secondary" onclick="window.print()">인쇄하기</button>
    </div>
</div>

<div class="tabs no-print">
    <button class="tab-btn active" onclick="showTab('stampDoc')">사용인감계</button>
    <button class="tab-btn" onclick="showTab('bizDoc')">사업자등록증 (법인)</button>
</div>

<div id="documentContainer">

    <div id="stampDoc" class="document-page active">
        <button class="btn btn-download no-print" onclick="downloadImage('stampDoc', '사용인감계_데이지.png')">이미지 다운로드</button>
        
        <h1>사 용 인 감 계</h1>

        <div style="margin-bottom: 40px;">
            <h3 style="border-bottom: 2px solid #333; padding-bottom: 10px;">1. 인감 등록</h3>
            <p style="margin-bottom: 20px;">본 법인은 아래의 법인인감을 본점에 등기된 인감으로 하고, 아래의 사용인감(데이지 도장)을 업무 수행 시 사용함을 신고합니다.</p>
            <table>
                <thead>
                    <tr>
                        <th style="width: 20%;">구분</th>
                        <th style="width: 40%;">법인인감 (등기인감)</th>
                        <th style="width: 40%;">사용인감</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="font-weight: bold;">날 인</td>
                        <td class="seal-cell">
                            <div style="position: absolute; bottom: 10px; width: 100%; color: #999;">(법인인감 날인)</div>
                            <div class="seal-style seal-corp"><span>주식회사<br>데이지<br>대표이사인</span></div>
                        </td>
                        <td class="seal-cell">
                            <div style="position: absolute; bottom: 10px; width: 100%; color: #999;">(사용인감 날인)</div>
                            <div class="seal-style seal-corp" style="box-shadow: 0 0 0 4px #fff, 0 0 0 8px var(--seal-color);"><span>주식회사<br>데이지<br>사용인감</span></div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div style="margin-bottom: 40px;">
            <h3 style="border-bottom: 2px solid #333; padding-bottom: 10px;">2. 업체 정보</h3>
            <table>
                <tr>
                    <th style="width: 30%;">상 호</th>
                    <td style="font-weight: bold; font-size: 16px;">데이지(Daisy)</td>
                </tr>
                <tr>
                    <th>주 소</th>
                    <td>서울특별시 강남구 테헤란로 521, 20층 (삼성동, 파르나스타워)</td>
                </tr>
                <tr>
                    <th>대표자</th>
                    <td style="text-align: left; padding-left: 30px;">
                        <span class="seal-rep-container">
                            성기범 (인)
                            <div class="seal-style seal-rep"><span>성기범<br>인</span></div>
                        </span>
                    </td>
                </tr>
            </table>
        </div>

        <div style="margin-bottom: 40px;">
            <h3 style="border-bottom: 2px solid #333; padding-bottom: 10px;">3. 사용인감 사용에 관한 확인</h3>
            <p style="line-height: 1.8;">본 사용인감은 상기 법인의 업무상 계약, 신청, 제출 서류 등에 사용하며, 해당 사용인감으로 행해진 모든 행위에 대하여 법인인감과 동일한 법적 효력을 가짐을 확인합니다. 또한 본 사용인감은 법인인감의 대용으로 사용되는 것으로, 본 법인은 이와 관련하여 발생하는 모든 책임을 부담할 것을 확약합니다.</p>
        </div>

        <div style="text-align: center; margin-top: 60px;">
            <p class="display-date" style="font-size: 18px; font-weight: bold;">2020년 3월 20일</p>
            <br>
            <div style="display: inline-block; text-align: left; margin-top: 20px;">
                <p>상호 : 데이지(Daisy)</p>
                <p>주소 : 서울특별시 강남구 테헤란로 521, 20층 (삼성동, 파르나스타워)</p>
                <div style="margin-top: 15px;">
                    <span class="seal-rep-container">
                        대표자 : 성기범 (인)
                        <div class="seal-style seal-rep" style="width: 70px; height: 70px; font-size: 14px; border-width: 4px;"><span>주식회사<br>데이지<br>의인</span></div>
                    </span>
                </div>
            </div>
        </div>

        <div style="margin-top: 60px; text-align: center;">
            <p style="font-size: 24px; font-weight: bold; font-family: 'Gungsuh', serif;"><span class="display-recipient">ㅇㅇㅇ</span> 귀중</p>
        </div>
    </div>

    <div id="bizDoc" class="document-page">
        <button class="btn btn-download no-print" onclick="downloadImage('bizDoc', '사업자등록증_데이지.png')">이미지 다운로드</button>

        <div class="content-wrap">
            <h1>사업자등록증</h1>
            <div class="doc-type">( 법 인 사 업 자 )</div>

            <table class="biz-info-table">
                <tr>
                    <th>등록번호</th>
                    <td colspan="3" style="font-size: 22px; color: #333; letter-spacing: 2px;">123-81-67890</td>
                </tr>
                <tr>
                    <th>법인명(단체명)</th>
                    <td style="font-size: 18px;">데이지(Daisy)</td>
                    <th style="width: 100px; text-align: center;">대 표 자</th>
                    <td style="font-size: 18px;">성기범</td>
                </tr>
                <tr>
                    <th>개업연월일</th>
                    <td class="display-date-short" style="font-size: 18px;">2020년 03월 20일</td>
                    <th style="text-align: center;">법인등록번호</th>
                    <td style="font-size: 18px;">110111-1234567</td>
                </tr>
                <tr>
                    <th>사업장 소재지</th>
                    <td colspan="3" style="font-size: 18px;">서울특별시 강남구 테헤란로 521, 20층 (삼성동, 파르나스타워)</td>
                </tr>
                <tr>
                    <th>본점 소재지</th>
                    <td colspan="3" style="font-size: 18px;">서울특별시 강남구 테헤란로 521, 20층 (삼성동, 파르나스타워)</td>
                </tr>
                <tr class="merged-row">
                    <th>사 업 의   종 류</th>
                    <td colspan="3" style="padding: 0;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <th style="border-bottom: 1px solid #ddd; border-right: 1px solid #ddd; width: 80px; text-align: center; background-color: #f9f9f9;">업 태</th>
                                <td style="border-bottom: 1px solid #ddd; padding: 10px; font-size: 18px;">서비스업</td>
                            </tr>
                            <tr>
                                <th style="border-right: 1px solid #ddd; text-align: center; background-color: #f9f9f9;">종 목</th>
                                <td style="padding: 10px; font-size: 18px;">인터넷 만남 매칭 서비스, 데이터베이스 제공</td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>

            <div class="issue-info">
                <p style="margin-bottom: 40px;">부가가치세법 제8조 및 동법 시행령 제11조의 규정에 의하여<br>사업자등록을 하였음을 증명합니다.</p>
                
                <p class="display-date" style="font-size: 22px; font-weight: bold;">2020년 3월 20일</p>
                
                <div class="tax-office-seal-group">
                    <span class="tax-office-name">강 남 세 무 서 장</span>
                    <div class="official-seal-rect">강남<br>세무서장<br>인</div>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    // 탭 전환 기능
    function showTab(tabId) {
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');

        document.querySelectorAll('.document-page').forEach(page => {
            page.classList.remove('active');
        });
        document.getElementById(tabId).classList.add('active');
    }

    // 문서 내용 업데이트 기능
    function updateDocuments() {
        const dateInput = document.getElementById('docDate').value;
        const recipientInput = document.getElementById('recipientName').value;

        if (!dateInput) {
            alert('날짜를 선택해주세요.');
            return;
        }

        const date = new Date(dateInput);
        const year = date.getFullYear();
        const month = date.getMonth() + 1;
        const day = date.getDate();
        
        const formattedDateLong = `${year}년 ${month}월 ${day}일`;
        const formattedDateShort = `${year}년 ${String(month).padStart(2, '0')}월 ${String(day).padStart(2, '0')}일`;

        // 모든 문서에 날짜 적용
        document.querySelectorAll('.display-date').forEach(el => el.innerText = formattedDateLong);
        document.querySelectorAll('.display-date-short').forEach(el => el.innerText = formattedDateShort);

        // 사용인감계 수신인 적용
        if (recipientInput) {
            document.querySelectorAll('.display-recipient').forEach(el => el.innerText = recipientInput);
        }

        alert('문서 내용이 업데이트되었습니다. 확인 후 이미지를 다운로드하세요.');
    }

    // 이미지 다운로드 기능 (html2canvas 고해상도 설정)
    function downloadImage(elementId, fileName) {
        const element = document.getElementById(elementId);
        const originalStyle = element.style.cssText;
        
        // 캡처를 위해 잠시 스타일 변경 (숨김 요소 처리 등)
        element.classList.add('printing');
        const noPrintElements = element.querySelectorAll('.no-print');
        noPrintElements.forEach(el => el.style.visibility = 'hidden');

        // iOS 등 고해상도 디스플레이 대응을 위한 scale 조정
        const scale = window.devicePixelRatio > 1 ? window.devicePixelRatio : 2;

        html2canvas(element, {
            scale: scale, 
            useCORS: true,
            logging: false,
            backgroundColor: window.getComputedStyle(element).backgroundColor, // 배경색 유지
            allowTaint: true,
            scrollY: -window.scrollY // 스크롤 보정
        }).then(canvas => {
            // 스타일 복구
            element.classList.remove('printing');
            noPrintElements.forEach(el => el.style.visibility = 'visible');
            element.style.cssText = originalStyle;

            // 이미지 다운로드 실행
            const image = canvas.toDataURL("image/png");
            const link = document.createElement('a');
            link.download = fileName;
            link.href = image;
            link.click();
        }).catch(err => {
             console.error("이미지 캡처 오류:", err);
             alert("이미지 생성 중 오류가 발생했습니다. 다시 시도해주세요.");
             // 오류 발생 시에도 스타일 복구
             noPrintElements.forEach(el => el.style.visibility = 'visible');
        });
    }
    
    // 초기 로드 시 폰트 적용을 위한 지연 실행
    window.onload = function() {
        setTimeout(updateDocuments, 500); // 초기값 적용
    };
</script>

</body>
</html>
